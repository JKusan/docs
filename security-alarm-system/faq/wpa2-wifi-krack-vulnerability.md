---
layout: default
title: Konnected and the "KRACK" WPA2 WiFi vulnerability
breadcrumb: WPA2 Wifi "KRACK" vulnerability
comments: true
---

## WiFi security and the KRACK exploit

On October 16, 2017, security researchers revealed a [widespread WiFi security exploit known as KRACK](https://www.theverge.com/2017/10/16/16481136/wpa2-wi-fi-krack-vulnerability)
that makes the common WPA2 wireless security protocol vulnerable to exploit. Your Konnected devices, like most WiFi
enabled devices in your home, **are vulnerable** to this newly discovered security flaw. However, we believe that most 
Konnected users are a very low risk and we do not recommend that you need to take any action at this time. This article
details the specifics about the vulnerability and the risks related to Konnected users, as well as our plan for addressing
the problem. This page will be updated as we make progress on that plan.

### KRACK and Konnected

Konnected devices communicate to SmartThings in two different ways:
  
  1. Directly to the SmartThings Cloud via HTTPS secured API requests
  1. Over your local LAN to your SmartThings hub over unencrypted WiFi 

Status updates of your security system sensors, such as open/close events or motion events, are transmitted directly to
the SmartThings Cloud over HTTPS secured traffic. This means that even using the KRACK exploit, **attackers would not
be able to eavesdrop on your sensor status**. 

However, because the local LAN traffic is not encrypted, the KRACK exploit may allow a malicious person in physical
proximity to your WiFi network to eavesdrop on traffic between your Konnected device and your SmartThings hub. This local
communication is only used in a few circumstances:
  
  1. When configuring the pins/zones via the Konnected SmartApp
  1. When triggering the siren, door chime or switch
  1. When the SmartThings hub is _discovering_ new Konnected devices
  
The largest risk here is in #1 above, when configuring pins/zones in the Konnected SmartApp, the SmartApp passes Konnected
an OAuth token. If this token were compromised, the attacker could gain partial access to your SmartThings account (the
same level of access that the Konnected app has).

We believe this risk to be very low for most users for the following reasons:

  1. The KRACK exploit requires close proximity to execute, meaning that the attacker would have to be within WiFi range
  of the Konnected device. In most residential installations, it would be exceedingly unlikely that a sophisticated WiFi
  hacker would target a home WiFi network.
  
  1. The exchange of the sensitive OAuth token _only_ takes place when you use the Konnected SmartApp to save or update
  the pin/zone assignments or update the settings of a device. During normal monitoring operation, the Konnected device
  _only_ communicates over HTTPS secured traffic to the SmartThings Cloud, which is _not_ vulnerable to KRACK exploits.
   

### Mitigation Plan

Konnected is built on top open source software and hardware libraries and SDKs that are maintained by hundreds of
developers all over the world. In this case, the KRACK exploit is a flaw in the underlying WPA2 security protocol, which
in this is implemented by the maker of the WiFi chip. Konnected devices use the [Espressif ESP8266](http://espressif.com/en/products/hardware/esp8266ex/overview)
WiFi microprocessor, and [Espressif has already created a fix for the KRACK exploit](http://espressif.com/en/media_overview/news/espressif-releases-patches-wifi-vulnerabilities-cert-vu228519).

It will take some time, however, for the WiFi chip SDK fix from Espressif to make its way into a usable firmware update
for Konnected. The Konnected firmware is built on top of the open-source NodeMCU firmware, and an 
[issue is already open](https://github.com/nodemcu/nodemcu-firmware/issues/2138) for this new release.

Once a new NodeMCU firmware build is available, we'll work on a fix in the form of a Konnected firmware update. 